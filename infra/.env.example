#######################################
# Database
#######################################

# Psycopg2 URL (主要给 Alembic / 迁移工具使用)
POSTGRES_URL=postgresql://app:app@db:5432/app


#######################################
# Redis
#######################################

# Redis 实例地址（用于去重/缓存/队列）
REDIS_URL=redis://redis:6379/0


#######################################
# API Keys / Tokens (填入真实值时覆盖)
#######################################

# X 平台 API Token（数据抓取用）
X_BEARER_TOKEN=your_x_bearer_token_here

# GoPlus API Key（合约安全性查询）
GOPLUS_API_KEY=your_goplus_api_key_here

# Telegram Bot Token（用于消息通知）
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here


#######################################
# Feature Flags
#######################################

# 是否启用 Demo 模式（1: demo 样例数据，0: 正常运行）
DEMO_MODE=1


#######################################
# Sentiment & Keyphrase Analysis
#######################################

# Sentiment backend: rules=规则模型, hf=HuggingFace 模型
SENTIMENT_BACKEND=rules

# 严格模式: 0=错误时回退 rules, 1=错误时直接报错
SENTIMENT_STRICT=0

# HuggingFace 模型（默认 sentiment 用）
HF_MODEL=cardiffnlp/twitter-roberta-base-sentiment-latest

# 运行设备: cpu | cuda
HF_DEVICE=cpu

# Keyphrase backend: rules=规则模型, hf=HuggingFace 模型
KEYPHRASE_BACKEND=rules


#######################################
# Event Aggregation (Day5 新增)
#######################################

# 时间桶大小（秒）
EVENT_TIME_BUCKET_SEC=600

# 参与 topic_hash 的关键词 TopK 数量
EVENT_TOPIC_TOPK=3

# topic_hash 使用的哈希算法
EVENT_HASH_ALGO=blake2s

# Event key 版本号
EVENT_KEY_VERSION=v1

# 证据保留尾部（预留参数）
EVENT_EVIDENCE_TAIL=0


#######################################
# Latency Budgets (milliseconds)
#######################################

# Filter 阶段最大延迟
LATENCY_BUDGET_MS_FILTER=10

# 整个 pipeline 端到端延迟上限
LATENCY_BUDGET_MS_TOTAL=120000


#######################################
# LLM Refiner
#######################################

# 后端选择：llm | rules
REFINE_BACKEND=llm

# Refiner 摘要最大长度
REFINE_SUMMARY_MAXLEN=80

# Refiner 阶段最大延迟 (ms)
LATENCY_BUDGET_MS_REFINE=3200

# Refiner 阶段超时阈值 (ms)
REFINE_TIMEOUT_MS=3500

# Refiner 最大重试次数
REFINE_MAX_RETRIES=0

# Refiner 提供方 (默认 openai，可替换为其他 SDK)
REFINE_PROVIDER=openai

# Refiner 使用的模型 (推荐 gpt-5-mini，兼顾成本与延迟)
REFINE_MODEL=gpt-5-mini

# Refiner fallback models (comma-separated)
REFINE_FALLBACK_MODELS=gpt-4o-mini,gpt-4o

# OpenAI API Key (本地需手动填写，不要提交到仓库)
# OPENAI_API_KEY=sk-xxxxxxx


#######################################
# GoPlus Security (Day7)
#######################################

# Authentication (prioritized: access_token > api_key > client_id/secret)
GOPLUS_ACCESS_TOKEN=
GOPLUS_API_KEY=your_goplus_api_key_here
GOPLUS_CLIENT_ID=
GOPLUS_CLIENT_SECRET=

# HTTP Configuration
GOPLUS_TIMEOUT_MS=4000
GOPLUS_RETRY=2
GOPLUS_RATELIMIT_RPM=28

# Cache Configuration
SECURITY_CACHE_TTL_S=600
SECURITY_DB_TTL_S=86400
SECURITY_ALLOW_STALE=true
SECURITY_STALE_MAX_S=172800

# Backend & Job Configuration
SECURITY_BACKEND=rules
ENABLE_GOPLUS_SCAN=false
GOPLUS_SCAN_BATCH=50
GOPLUS_SCAN_INTERVAL_S=10

# Risk Thresholds
RISK_TAX_RED=10
RISK_LP_YELLOW_DAYS=30
HONEYPOT_RED=true
RISK_MIN_CONFIDENCE=0.6


#######################################
# X (Twitter) Data Collection (Day8)
#######################################

# Backend selection: graphql|api|apify|off
X_BACKEND=graphql

# KOL handles to track (comma-separated)
X_KOL_HANDLES=elonmusk,whale_alert,cryptocom

# Polling configuration
X_POLL_INTERVAL_SEC=120
X_BATCH_SIZE=5
X_MAX_PER_USER=20

# HTTP configuration
X_REQUEST_TIMEOUT=10
X_PROXY_URL=

# GraphQL backend credentials
X_GRAPHQL_AUTH_TOKEN=your_graphql_auth_token_here
X_GRAPHQL_CT0=your_graphql_ct0_here

# Optional toggles/query ids
X_GRAPHQL_MOCK=false
X_GRAPHQL_USER_QUERY_ID=UserByScreenName
X_GRAPHQL_TWEETS_QUERY_ID=UserTweets

# API backend credentials (placeholder)
X_API_BEARER=your_api_bearer_token_here

# Apify backend credentials (placeholder)
X_APIFY_TOKEN=your_apify_token_here

# Feature flags
X_ENABLE_LINK_EXPAND=true
ENABLE_X_INGESTOR=true

# Avatar monitoring (Day8.1)
X_ENABLE_AVATAR_MONITOR=false
# Optional: mock bump to force deterministic avatar change on each run
X_AVATAR_MOCK_BUMP=0
# Optional: poll interval (document-only; worker 手动触发不使用)
X_AVATAR_POLL_INTERVAL_SEC=300


#######################################
# Topic Signal Detection (Day9.1)
#######################################

# Topic aggregation configuration
DAILY_TOPIC_PUSH_CAP=50
TOPIC_WINDOW_HOURS=24
TOPIC_SLOPE_WINDOW_10M=10
TOPIC_SLOPE_WINDOW_30M=30

# Topic similarity thresholds
TOPIC_SIM_THRESHOLD=0.80
TOPIC_JACCARD_FALLBACK=0.50
TOPIC_WHITELIST_BOOST=0.05

# Mini LLM configuration
MINI_LLM_TIMEOUT_MS=1200

# Backend selection
EMBEDDING_BACKEND=hf
KEYBERT_BACKEND=kb

# Telegram notification
TELEGRAM_SANDBOX_CHAT_ID=your_telegram_chat_id_here

# --- Telegram minimal adapter for Day9.1 ---
# mock | real
TELEGRAM_MODE=mock
# mock 写入路径
TELEGRAM_MOCK_PATH=/tmp/telegram_sandbox.jsonl
# 以下用于 real 模式
TELEGRAM_BOT_TOKEN=
TELEGRAM_SANDBOX_CHAT_ID=