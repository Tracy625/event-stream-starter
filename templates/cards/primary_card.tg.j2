{#- Primary Card Template for Telegram (Markdown) -#}
{#- Risk color header -#}
{%- if card_data.risk_level == 'red' -%}
ğŸ”´ **é«˜é£é™©è­¦æŠ¥**
{%- elif card_data.risk_level == 'yellow' -%}
ğŸŸ¡ **ä¸­é£é™©æç¤º**
{%- elif card_data.risk_level == 'gray' -%}
âš« **æœåŠ¡é™çº§**
{%- else -%}
ğŸŸ¢ **ä½é£é™©ä¿¡å·**
{%- endif %}

**å€™é€‰ä»£å¸:** {{ card_data.token_info.symbol | default('UNKNOWN') }} ({{ card_data.token_info.chain | default('eth') | upper }})
{%- if card_data.token_info.ca_norm %}
**åˆçº¦åœ°å€:** `{{ card_data.token_info.ca_norm[:6] }}...{{ card_data.token_info.ca_norm[-4:] }}`
{%- endif %}

{#- Risk warning block - only show for non-green -#}
{%- if card_data.risk_level in ['red', 'yellow', 'gray'] %}
âš ï¸ **é£é™©æç¤º:** {{ card_data.risk_note }}
{%- endif %}

ğŸ“Š **å¸‚åœºæ•°æ®**
â€¢ ä»·æ ¼: ${{ "%.6f" | format(card_data.metrics.price_usd) if card_data.metrics.price_usd else "å¾…è·å–" }}
â€¢ æµåŠ¨æ€§: ${{ "{:,.0f}".format(card_data.metrics.liquidity_usd) if card_data.metrics.liquidity_usd else "å¾…è·å–" }}
â€¢ FDV: ${{ "{:,.0f}".format(card_data.metrics.fdv) if card_data.metrics.fdv else "å¾…è·å–" }}
{%- if card_data.metrics.ohlc and card_data.metrics.ohlc.h24 and card_data.metrics.ohlc.h24.c %}
â€¢ 24h å˜åŒ–: {{ "%.2f" | format(((card_data.metrics.ohlc.h24.c - card_data.metrics.ohlc.h24.o) / card_data.metrics.ohlc.h24.o * 100) if card_data.metrics.ohlc.h24.o else 0) }}%
{%- endif %}

{#- Degraded state warning -#}
{%- if card_data.states.degrade %}
âš ï¸ **æœåŠ¡é™çº§æç¤º:** éƒ¨åˆ†æ•°æ®æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œæ˜¾ç¤ºç»“æœåŸºäºç¼“å­˜æˆ–é™çº§ç­–ç•¥
{%- endif %}

ğŸ” **éªŒè¯è·¯å¾„:** {{ card_data.verify_path }}
ğŸ“… **æ•°æ®æ—¶é—´:** {{ card_data.data_as_of }}

{#- Legal note -#}
_{{ card_data.legal_note or "æœ¬ä¿¡æ¯ä»…ä¸ºé£é™©çº¿ç´¢ä¸æŠ€æœ¯åˆ¤æ–­ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚" }}_

{#- Hidden debug block for rules_fired and risk_source -#}
<!-- Debug: rules_fired = {{ card_data.rules_fired | tojson if card_data.rules_fired else '[]' }} -->
<!-- Debug: risk_source = {{ card_data.sources.security_source if card_data.sources.security_source else '' }} -->

{#- Ambiguous candidates block -#}
{%- if card_data.ambiguous_candidates and (card_data.ambiguous_candidates | length) >= 2 %}

â€”â€”â€”
ğŸ” **æ­§ä¹‰å€™é€‰ï¼ˆå¾…ç¡®è®¤ï¼‰**
{%- for c in card_data.ambiguous_candidates %}
â€¢ {{ loop.index }}. {{ c.chain | upper }} `{{ c.ca[:6] }}...{{ c.ca[-4:] }}`  
  LP: ${{ "{:,.0f}".format(c.lp_usd) if c.lp_usd else "?" }} | åˆ†æ•°: {{ '%.2f'|format(c.score) }} | Î”t: {{ c.t_delta_min if c.t_delta_min is not none else '?' }}m  
  {{ 'ğŸŸ©' if c.evidence_strength=='strong' else ('ğŸŸ¨' if c.evidence_strength=='medium' else 'â¬œï¸') }} {{ c.pair_url }}
{%- endfor %}
_è¯´æ˜ï¼šå€™é€‰æ± å¾…ç¡®è®¤ï¼Œæš‚ä¸ä¸‹â€œå¯ä¹°â€ç»“è®º_

{%- endif %}
